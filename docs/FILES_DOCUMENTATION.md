# توثيق الملفات والمجلدات (هيكل Monorepo)

## نظرة عامة على الهيكل

اتبع المشروع هيكلية "monorepo" لفصل التطبيقات (`apps`) عن الكود المشترك (`packages`) وملفات الإعداد (`configs`) لتحسين الصيانة وقابلية التوسع.

---

## 1. مجلد `apps/`

*   **الوظيفة/الدور:** يحتوي على التطبيقات المستقلة والقابلة للتشغيل.
*   **المحتويات الرئيسية:** `frontend` و `backend`.

### `apps/frontend/`
*   **النوع:** مجلد (تطبيق React).
*   **الوظيفة/الدور:** يضم الواجهة الأمامية للمشروع المبنية باستخدام React و Vite.
*   **نقاط التكامل:** يعتمد على الحزم في `packages/shared` للوصول إلى الكود المشترك، ويتم بناؤه عبر الإعدادات في `configs/vite.config.ts`.

### `apps/backend/`
*   **النوع:** مجلد (تطبيق Express).
*   **الوظيفة/الدور:** يحتوي على الخادم الخلفي المبني باستخدام Express.js. الكود المصدري منظم داخل `apps/backend/src/`.
*   **نقاط التكامل:** يتصل بقاعدة البيانات عبر المخطط الموجود في `packages/shared/schema` ويخدم الـ API الذي تستهلكه الواجهة الأمامية.

---

## 2. مجلد `packages/`

*   **الوظيفة/الدور:** يحتوي على حزم الكود المشترك التي لا يمكن تشغيلها بشكل مستقل ولكن تُستخدم من قبل التطبيقات في `apps/`.

### `packages/shared/`
*   **النوع:** مجلد (حزمة مشتركة).
*   **الوظيفة/الدور:** يجمع كل الكود الذي يتم مشاركته بين الواجهة الأمامية والخلفية.
*   **المحتويات الرئيسية:**
    *   `schema/`: لتعريف مخطط قاعدة البيانات (Drizzle ORM).
    *   `screenplay/`: لوظائف معالجة وتحليل نصوص السيناريو.
    *   `utils/`: للأدوات المساعدة العامة.

### `packages/shared/schema/users.ts`
*   **النوع:** ملف TypeScript.
*   **الوظيفة/الدور:** يعرّف مخطط جدول `users` باستخدام Drizzle.
*   **نقاط التكامل:** يُستخدم من `apps/backend` لإجراء عمليات قاعدة البيانات، ومن `apps/frontend` (بشكل غير مباشر) لأنواع البيانات.

### `packages/shared/screenplay/*.ts`
*   **النوع:** ملفات TypeScript.
*   **الوظيفة/الدور:** تحتوي على المنطق الخاص بمعالجة السيناريو (`coordinator.ts`, `agents.ts`, `patterns.ts`, etc.).
*   **نقاط التكامل:** تُستدعى بشكل أساسي من محرر السيناريو في `apps/frontend`.

---

## 3. مجلد `configs/`

*   **الوظيفة/الدور:** يجمع ملفات الإعداد المركزية للمشروع.

### `configs/vite.config.ts`
*   **النوع:** ملف إعداد Vite.
*   **الوظيفة/الدور:** يضبط إعدادات بناء وتشغيل الواجهة الأمامية.
*   **المخاطر/الملاحظات:** تم تحديث مسارات `root`, `publicDir`, و `outDir` لتعكس موقع `apps/frontend`.

### `configs/tailwind.config.ts`
*   **النوع:** ملف إعداد Tailwind CSS.
*   **الوظيفة/الدور:** يحدد إعدادات Tailwind.
*   **المخاطر/الملاحظات:** تم تحديث مسار `content` ليشمل الملفات داخل `apps/frontend`.

### `configs/tsconfig.base.json`
*   **النوع:** ملف إعداد TypeScript.
*   **الوظيفة/الدور:** يوفر الإعدادات الأساسية لـ TypeScript للمشروع بأكمله، بما في ذلك تعريفات المسارات (`@frontend`, `@backend`, `@shared`).

---

## 4. ملفات الجذر (Root Files)

### `package.json`
*   **النوع:** ملف إعداد npm.
*   **الوظيفة/الدور:** يعرّف المشروع كـ monorepo باستخدام `workspaces`، ويحتوي على جميع الاعتماديات والسكربتات (`dev`, `build`, `start`).
*   **المخاطر/الملاحظات:** تم تحديث السكربتات لتعمل مع هيكل `apps` و `configs`.

### `tsconfig.json`
*   **النوع:** ملف إعداد TypeScript.
*   **الوظيفة/الدور:** ملف `tsconfig` الجذري الذي يمتد من `configs/tsconfig.base.json` لتهيئة المسارات.

### `drizzle.config.ts`
*   **النوع:** ملف إعداد Drizzle.
*   **الوظيفة/الدور:** يضبط Drizzle Kit.
*   **المخاطر/الملاحظات:** تم تحديث مسار `schema` ليشير إلى `packages/shared/schema/users.ts`.

### `firebase.json` و `.firebaserc`
*   **النوع:** ملفات إعداد Firebase.
*   **الوظيفة/الدور:** تظل في الجذر لضبط عمليات النشر (deploy) على Firebase Hosting و Functions. مسار `public` يشير الآن إلى `dist/public`.
